<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>IT ìì‚° ê´€ë¦¬ ëŒ€ì‹œë³´ë“œ</title>

<style>
  :root{
    --bg:#0f1116;
    --card:#161a22;
    --text:#e5e7eb;
    --muted:#9ca3af;
    --line:#2a2f3a;

    --c-total:#60a5fa;
    --c-in:#22c55e;
    --c-out:#fb923c;
    --c-repair:#9ca3af;
    --c-retired:#ef4444;
  }

  body{
    margin:0;
    font-family: system-ui, -apple-system, Segoe UI, Roboto;
    background:var(--bg);
    color:var(--text);
  }

  .wrap{
    max-width:1100px;
    margin:26px auto;
    padding:0 16px;
  }

  h1{ margin:0 0 14px; }

  /* KPI */
  .kpi{
    display:flex;
    gap:12px;
    flex-wrap:wrap;
    margin-bottom:14px;
  }
  .kpi .card{
    background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,0));
    border:1px solid var(--line);
    border-radius:14px;
    padding:12px 16px;
    min-width:120px;
    cursor:pointer;
  }
  .kpi .card.active{
    box-shadow:0 0 0 1px rgba(255,255,255,.2);
  }
  .kpi .label{
    display:flex;
    align-items:center;
    gap:8px;
    font-weight:700;
  }
  .dot{
    width:10px;height:10px;border-radius:50%;
  }
  .card[data-kind="total"] .dot{background:var(--c-total);}
  .card[data-kind="in"] .dot{background:var(--c-in);}
  .card[data-kind="out"] .dot{background:var(--c-out);}
  .card[data-kind="repair"] .dot{background:var(--c-repair);}
  .card[data-kind="retired"] .dot{background:var(--c-retired);}
  .kpi .n{
    font-size:22px;
    font-weight:800;
    margin-top:6px;
  }

  /* ìš”ì•½ */
  .summary{
    background:var(--card);
    border:1px solid var(--line);
    border-radius:14px;
    padding:12px;
    margin-bottom:14px;
  }
  .summary h2{
    margin:0 0 10px;
    font-size:14px;
    color:#cfd5e1;
  }
  .summary-grid{
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(160px,1fr));
    gap:10px;
  }
  .type-card{
    border:1px solid rgba(255,255,255,.12);
    border-radius:12px;
    padding:10px 12px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    cursor:pointer;
  }
  .type-left{
    display:flex;
    align-items:center;
    gap:10px;
  }
  .typeicon{
    width:28px;height:28px;
    border-radius:10px;
    display:flex;
    align-items:center;
    justify-content:center;
    background:rgba(255,255,255,.05);
  }
  .typecount{
    font-weight:800;
    padding:4px 10px;
    border-radius:999px;
    background:#0b0e14;
    border:1px solid var(--line);
  }

  /* í•„í„° */
  .toolbar{
    display:flex;
    gap:12px;
    margin-bottom:14px;
    flex-wrap:wrap;
  }
  input,select{
    background:#0b0e14;
    color:var(--text);
    border:1px solid var(--line);
    border-radius:12px;
    padding:10px 12px;
  }

  /* í…Œì´ë¸” */
  .table-wrap{
    background:var(--card);
    border:1px solid var(--line);
    border-radius:14px;
    overflow:auto;
  }
  table{
    width:100%;
    border-collapse:collapse;
    min-width:900px;
  }
  th,td{
    padding:12px;
    border-bottom:1px solid var(--line);
  }
  th{background:#121620;}
  tr:hover{background:#0f1420;}

  /* ìƒíƒœ */
  .badge{
    padding:4px 10px;
    border-radius:999px;
    font-size:12px;
    font-weight:800;
    color:#fff;
  }
  .st-in{background:#16a34a;}
  .st-out{background:#f97316;}
  .st-repair{background:#6b7280;}
  .st-retired{background:#dc2626;}
  .st-unknown{background:#374151;}

  .btn{
    padding:6px 10px;
    border-radius:10px;
    border:1px solid var(--line);
    background:#0b0e14;
    color:#fff;
    cursor:pointer;
  }

  .empty{
    padding:30px;
    text-align:center;
    color:var(--muted);
  }
</style>
</head>

<body>
<div class="wrap">
  <h1>IT ìì‚° ê´€ë¦¬ ëŒ€ì‹œë³´ë“œ</h1>

  <div class="kpi">
    <div class="card active" id="card-total" data-kind="total"><div class="label"><span class="dot"></span>ì´ ìì‚°</div><div class="n" id="k-total">0</div></div>
    <div class="card" id="card-in" data-kind="in"><div class="label"><span class="dot"></span>IN</div><div class="n" id="k-in">0</div></div>
    <div class="card" id="card-out" data-kind="out"><div class="label"><span class="dot"></span>OUT</div><div class="n" id="k-out">0</div></div>
    <div class="card" id="card-repair" data-kind="repair"><div class="label"><span class="dot"></span>ìˆ˜ë¦¬ì¤‘</div><div class="n" id="k-repair">0</div></div>
    <div class="card" id="card-retired" data-kind="retired"><div class="label"><span class="dot"></span>íê¸°</div><div class="n" id="k-retired">0</div></div>
  </div>

  <div class="summary" id="summary"></div>

  <div class="toolbar">
    <input id="q" placeholder="ê²€ìƒ‰" />
    <select id="status">
      <option value="">ìƒíƒœ ì „ì²´</option>
      <option value="in">IN</option>
      <option value="out">OUT</option>
      <option value="repair">ìˆ˜ë¦¬ì¤‘</option>
      <option value="retired">íê¸°</option>
    </select>
  </div>

  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th>#</th><th>êµ¬ë¶„</th><th>ëª¨ë¸ëª…</th><th>ì‹œë¦¬ì–¼</th>
          <th>ì‚¬ìš©ì</th><th>êµ¬ë§¤ì¼</th><th>ìƒíƒœ</th><th>ì¸ì‡„</th>
        </tr>
      </thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>

  <div class="empty" id="empty" style="display:none;">í‘œì‹œí•  ìì‚°ì´ ì—†ìŠµë‹ˆë‹¤.</div>
</div>

<script>
async function main(){
  const res = await fetch('assets.json',{cache:'no-store'});
  const issues = await res.json();

  function pick(b,r){const m=b.match(r);return m?m[1].trim():'-';}
  function labelsToKey(l){
    if(l.includes('in'))return'in';
    if(l.includes('out'))return'out';
    if(l.includes('repair'))return'repair';
    if(l.includes('retired'))return'retired';
    return'unknown';
  }
  function icon(type){
    const t=type.toLowerCase();
    if(t.includes('ë…¸íŠ¸ë¶'))return'ğŸ’»';
    if(t.includes('ëª¨ë‹ˆí„°'))return'ğŸ–¥ï¸';
    if(t.includes('ëª¨ë°”ì¼'))return'ğŸ“±';   // âœ… ëª¨ë°”ì¼ ì¶”ê°€
    return'ğŸ“¦';
  }

  const assets=issues.map(i=>{
    const body=i.body||'';
    const labels=(i.labels||[]).map(l=>l.toLowerCase());
    const key=labelsToKey(labels);
    return{
      number:i.number,
      type:pick(body,/êµ¬ë¶„:\s*(.+)/),
      model:i.title||'-',
      serial:pick(body,/ì‹œë¦¬ì–¼:\s*(.+)/),
      user:pick(body,/ì‚¬ìš©ì:\s*(.+)/),
      buy:pick(body,/êµ¬ë§¤ì¼:\s*([0-9\-\.]+)/).replace(/\./g,'-'),
      key,
      text:{in:'IN',out:'OUT',repair:'ìˆ˜ë¦¬ì¤‘',retired:'íê¸°',unknown:'ë¯¸ì§€ì •'}[key],
      hay:(i.title+body).toLowerCase()
    };
  });

  // KPI
  k('k-total',assets.length);
  k('k-in',assets.filter(a=>a.key==='in').length);
  k('k-out',assets.filter(a=>a.key==='out').length);
  k('k-repair',assets.filter(a=>a.key==='repair').length);
  k('k-retired',assets.filter(a=>a.key==='retired').length);

  const tbody=el('tbody'), empty=el('empty'), summary=el('summary');

  function renderSummary(){
    const map={};
    assets.forEach(a=>{map[a.type]=(map[a.type]||0)+1;});
    summary.innerHTML=`<h2>ì „ì²´ ìì‚° í˜„í™©</h2>
      <div class="summary-grid">
        ${Object.keys(map).map(t=>`
          <div class="type-card">
            <div class="type-left">
              <div class="typeicon">${icon(t)}</div>
              <div>${t}</div>
            </div>
            <div class="typecount">${map[t]}</div>
          </div>`).join('')}
      </div>`;
  }

  function render(){
    const q=el('q').value.toLowerCase();
    const st=el('status').value;
    const rows=assets.filter(a=>(!q||a.hay.includes(q))&&(!st||a.key===st));
    tbody.innerHTML=rows.map(a=>`
      <tr>
        <td>${a.number}</td><td>${a.type}</td><td>${a.model}</td><td>${a.serial}</td>
        <td>${a.user}</td><td>${a.buy}</td>
        <td><span class="badge st-${a.key}">${a.text}</span></td>
        <td><button class="btn" onclick="window.print()">ì¸ì‡„</button></td>
      </tr>`).join('');
    empty.style.display=rows.length?'none':'block';
  }

  el('q').oninput=render;
  el('status').onchange=render;

  renderSummary();
  render();
}

function el(id){return document.getElementById(id);}
function k(id,v){el(id).textContent=v;}

main();
</script>
</body>
</html>
